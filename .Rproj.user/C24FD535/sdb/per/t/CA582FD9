{
    "contents" : "source(\"scripts/functions.R\")\n#source(\"scripts/trait_cleaning.R\")\n\noptions(na.action = \"na.fail\")\n\nlibrary(plyr)\nlibrary(reshape2)\nlibrary(reshape)\nlibrary(FD)\nlibrary(ggplot2)\nlibrary(missForest)\nlibrary(SYNCSA)\nlibrary(fossil)\nrequire(vegan)\nrequire(MuMIn)\nrequire(nlme)\n\n\nalldata_reduced <- read.csv(\"data/alldata_reduced2.csv\", header=T)\n\n\n# order: hydrology, flow mod., land use, climate, soil, exotics\n\n# FDis #\n\ngetAllStats(alldata_reduced, alldata_reduced$FDis, FD)\n\nFDis <- lme(FDis ~ C_MaxM.x + I(C_MaxM.x^2) + LSPeak.x + I(LSPeak.x^2) + soil_soc, random = ~1|replicate, data = alldata_reduced)\nFDis.1 <- lm(FDis ~ C_MaxM.x + I(C_MaxM.x^2) + LSPeak.x + I(LSPeak.x^2) + soil_soc, data = alldata_reduced)\nFDis.2 <- lme(FDis ~ C_MaxM.x + I(C_MaxM.x^2) + LSPeak.x + I(LSPeak.x^2), random = ~1|replicate, data = alldata_reduced)\nFDis.3 <- lm(FDis ~ C_MaxM.x + I(C_MaxM.x^2) + LSPeak.x + I(LSPeak.x^2), data = alldata_reduced)\nFDis.4 <- lm(FDis ~ C_MaxM.x + I(C_MaxM.x^2), data = alldata_reduced)\nFDis.4a <- lm(log10(FDis) ~ C_MaxM.x + I(C_MaxM.x^2), data = alldata_reduced)\nFDis.5 <- lme(FDis ~ C_MaxM.x + I(C_MaxM.x^2), random = ~1|replicate, data = alldata_reduced)\nFDis.6 <- lm(FDis ~  C_MaxM.x + I(C_MaxM.x^2) + regulation + I(regulation^2), data = alldata_reduced)\n\nAICc(FDis,FDis.1,FDis.2,FDis.3,FDis.4, FDis.4a,FDis.5, FDis.6)\n\nFDis.varpart <- varpart(alldata_reduced$FDis,\n                        ~ C_MaxM.x + I(C_MaxM.x^2),\n                        ~ LSPeak.x + I(LSPeak.x^2),\n                        ~ soil_soc,\n                        data = alldata_reduced)\nFDis.varpart\nplot(FDis.varpart)\n\n\n\n# FRic\n\n\ngetAllStats(alldata_reduced, alldata_reduced$FRic, FD)\n\nFRic.y.varpart <- varpart(alldata_reduced$FRic,\n                          ~ M_MinM.y, \n                          ~ M_MaxM.y,\n                          data = alldata_reduced)\nFRic.y.varpart\nplot(FRic.y.varpart)\n\nFRic.y.lm <-lm(FRic ~ M_MinM.y + M_MaxM.y, alldata_reduced)\nsubset(dredge(FRic.y.lm), delta <4)\n\nFRic.soil.varpart <- varpart(alldata_reduced$FRic,\n                             ~soil_phc,\n                             ~soil_pto,\n                             data = alldata_reduced)\nFRic.soil.varpart\nplot(FRic.soil.varpart)\n\nFRic.soil.lm <-lm(FRic ~ soil_phc + soil_pto, alldata_reduced)\nsubset(dredge(FRic.soil.lm), delta <4)\n\n\nFRic.clim.varpart <- varpart(alldata_reduced$FRic,\n                             ~ clim_pdry + I(clim_pdry^2),\n                             ~ clim_tsea,\n                             ~ clim_pwet + I(clim_pwet^2),\n                             data = alldata_reduced)\nFRic.clim.varpart\nplot(FRic.clim.varpart)\n\nFRic.clim.lm <-lm(FRic ~ clim_pdry + I(clim_pdry^2) + clim_tsea + clim_pwet + I(clim_pwet^2), alldata_reduced)\nsubset(dredge(FRic.clim.lm), delta <4)\n\n# order: flow mod., hydrology, land use, climate, soil, exotics\n\nFRic.varpart <- varpart(alldata_reduced$FRic,\n                        ~ M_MinM.y,\n                        ~ production_irrigated_w,\n                        ~ clim_pdry + I(clim_pdry^2),\n                        ~ soil_pto,\n                        scale=TRUE,\n\n                        data = alldata_reduced)\nFRic.varpart\nplot(FRic.varpart)\n\nplot(FRic.varpart, bg = c(gray(0.1,1)), Xnames= c('flow mod.','land use','climate','soil'), id.size = 1)\n                        \nFRic.lm <- lm(FRic ~ M_MinM.y + production_irrigated_w + soil_phc + soil_pto, alldata_reduced)\nFRic.lm1 <- lm(FRic ~ M_MinM.y + production_irrigated_w + soil_pto, alldata_reduced)\nFRic.lme <- lme(FRic ~ M_MinM.y + production_irrigated_w + soil_phc + soil_pto, random = ~1|replicate,alldata_reduced)\nAICc(FRic.lm, FRic.lm1, FRic.lme)\n\nsummary(FRic.lm)\n\n# FDiv\n\ngetAllStats(alldata_reduced, alldata_reduced$FDiv, FD)\n\nsoil_nto\nsoil_soc\nclim_twrm\nCVAnnBFI.x\nMDFMDFDry.x\nLSPeak.x + I(LSPeak.x^2)\nC_MaxM.x + I(C_MaxM.x^2)\n\nFDiv.soil.varpart <- varpart(alldata_reduced$FDiv,\n                             ~soil_nto,\n                             ~soil_soc,\n                             data = alldata_reduced)\nFDiv.soil.varpart\nplot(FDiv.soil.varpart)\n\nFDiv.x.varpart <- varpart(alldata_reduced$FDiv,\n                          ~ CVAnnBFI.x,\n                          ~ MDFMDFDry.x,\n                          ~ LSPeak.x + I(LSPeak.x^2),\n                          ~ C_MaxM.x + I(C_MaxM.x^2),\n                          data = alldata_reduced)\nFDiv.x.varpart\nplot(FDiv.x.varpart)\n\n# order: flow mod., hydrology, land use, climate, soil, exotics\n\n\nFDiv.varpart <- varpart(alldata_reduced$FDiv,\n                        ~ CVAnnBFI.x + MDFMDFDry.x + LSPeak.x + I(LSPeak.x^2), # only hydrology matters\n                        ~ clim_twrm,\n                        ~ soil_nto + soil_soc,\n                        data = alldata_reduced)\nFDiv.varpart\nplot(FDiv.varpart, bg = c(gray(0.1,1)), Xnames= c('hydrology','climate','soil'), id.size =1)\n\nFDiv.lm <- lm(FDiv ~ CVAnnBFI.x + MDFMDFDry.x + LSPeak.x + I(LSPeak.x^2), data = alldata_reduced)\nsummary(FDiv.lm)     \n\n\n\n# FEve\n\ngetAllStats(alldata_reduced, alldata_reduced$FEve, FD)\n\n\nFEve.x.varpart <- varpart(alldata_reduced$FEve, \n                          ~ MDFMDFDry.x + I(MDFMDFDry.x^2),\n                          ~ LSPeak.x,\n                          data = alldata_reduced)\nFEve.x.varpart\nplot(FEve.x.varpart)\n\n# order: flow mod., hydrology, land use, climate, soil, exotics\n\nFEve.varpart <- varpart(alldata_reduced$FEve, \n                        ~ MDFMDFDry.x + I(MDFMDFDry.x^2) + LSPeak.x,\n                        ~ intensive_w,\n                        ~ clim_psea,\n                        data = alldata_reduced)\nFEve.varpart\nplot(FEve.varpart, bg = c(gray(0.1,1)), Xnames= c('hydrology','land use','climate'), id.size =1)\n\n\nFEve.lm <- lm(FEve ~ intensive_w + clim_psea + MDFMDFDry.x + I(MDFMDFDry.x^2) + LSPeak.x, data =alldata_reduced)\nsummary(FEve.lm)\n\n# exotics #\n\ngetAllStats(alldata_reduced, alldata_reduced$exotics, FD)\n\nexotics.x.lme <- lme(exotics ~ CVAnnBFI.x + I(CVAnnBFI.x^2)\n                 + CVAnnLSMeanDur.x\n                 + C_MinM.x + I(C_MinM.x^2)\n                 + LSMeanDur.x + I(LSMeanDur.x^2)\n                 + C_MaxM.x\n                 + CVMDFDry.x + I(CVMDFDry.x^2)\n                 + CVAnnHSMeanDur.x\n                 + HSPeak.x + I(HSPeak.x^2), \n                 random = ~1|replicate,\n                 data = alldata_reduced)\n#exotics.x.lm.dredge <- dredge(exotics.x.lme)\n#summary(model.avg(exotics.x.lme.dredge))\n\nexotics.x.varpart <- varpart(alldata_reduced$exotics,  \n                            ~ CVAnnBFI.x + I(CVAnnBFI.x^2),\n#                          ~ C_MinM.x + I(C_MinM.x^2),\n                         # ~ LSMeanDur.x + I(LSMeanDur.x^2),\n                          ~ C_MaxM.x,\n                          ~ CVMDFDry.x + I(CVMDFDry.x^2),\n                          ~ CVAnnHSMeanDur.x,\n                        #  ~ HSPeak.x + I(HSPeak.x^2), \n                          data = alldata_reduced)\nexotics.x.varpart\nplot(exotics.x.varpart)\n\n\nexotics.landuse.varpart <- varpart(alldata_reduced$exotics,\n                                   ~production_irrigated_w + I(production_irrigated_w^2),\n                                   ~production_natural_w,\n                        #           ~conservation_w + I(conservation_w^2),\n#                                   ~production_dryland_w, \n                                   data = alldata_reduced)\nexotics.landuse.varpart\nplot(exotics.landuse.varpart)\n\n\n#exotics.y.lm <- lm(exotics ~ C_MinM.y + I(C_MinM.y^2), data = alldata_reduced)\n\nexotics.soil.varpart <- varpart(alldata_reduced$exotics, \n                                ~soil_phc,\n                                ~soil_der,\n                                data = alldata_reduced)\nexotics.soil.varpart\nplot(exotics.soil.varpart)\n\n\nexotics.clim.varpart <- varpart(alldata_reduced$exotics, \n                 #              ~clim_tsea,\n                                ~clim_pdry + I(clim_pdry^2),\n                #                ~clim_pwet + I(clim_pwet^2),\n                                data = alldata_reduced)\nexotics.clim.varpart\nplot(exotics.clim.varpart)                                \n\n\n  # models\n\nexotics.x.lm <- lm(exotics ~ CVAnnBFI.x + I(CVAnnBFI.x^2)\n                            +LSMeanDur.x + I(LSMeanDur.x^2)\n                            +HSPeak.x + I(HSPeak.x^2), \n                   data = alldata_reduced)\nexotics.x.lme <- lme(exotics ~ CVAnnBFI.x + I(CVAnnBFI.x^2)\n                   +LSMeanDur.x + I(LSMeanDur.x^2)\n                   +HSPeak.x + I(HSPeak.x^2), \n                   random = ~1|replicate,\n                   data = alldata_reduced)\n\nexotics.landuse.lm <- lm(exotics ~production_irrigated_w + I(production_irrigated_w^2) \n                         + production_natural_w \n                         +conservation_w + I(conservation_w^2),\n                         data = alldata_reduced)\nexotics.landuse.lme <- lme(exotics ~ production_irrigated_w + I(production_irrigated_w^2) \n                           + production_natural_w \n                           +conservation_w + I(conservation_w^2),\n                           random = ~1|replicate,\n                           data = alldata_reduced)\n\nexotics.y.lm <- lm(exotics ~ C_MinM.y + I(C_MinM.y^2), data = alldata_reduced)\nexotics.y.lme<- lme(exotics ~ C_MinM.y + I(C_MinM.y^2), random = ~1|replicate, data = alldata_reduced)\n\nexotics.soil.lm <- lm(exotics ~ soil_phc + soil_der, data = alldata_reduced)\nexotics.soil.lme <- lme(exotics ~ soil_phc + soil_der, random = ~1|replicate, data = alldata_reduced)\n\nexotics.clim.lm <- lm(exotics ~ clim_tsea + clim_pdry + I(clim_pdry^2), data = alldata_reduced)\nexotics.clim.lme <- lme(exotics ~ clim_tsea + clim_pdry + I(clim_pdry^2), random = ~1|replicate, data = alldata_reduced)\n\nexotics.full.lm <- lm(exotics ~ CVAnnBFI.x + I(CVAnnBFI.x^2)\n                      +LSMeanDur.x + I(LSMeanDur.x^2) +HSPeak.x + I(HSPeak.x^2) \n                      + production_irrigated_w + I(production_irrigated_w^2)+ production_natural_w +conservation_w + I(conservation_w^2) \n                      + C_MinM.y + I(C_MinM.y^2) \n                      + clim_tsea + clim_pdry + I(clim_pdry^2), \n                      data = alldata_reduced)\n\nexotics.interaction.lm1a <- lm(exotics ~ CVAnnBFI.x + I(CVAnnBFI.x^2)+LSMeanDur.x + I(LSMeanDur.x^2)+HSPeak.x + I(HSPeak.x^2) + production_irrigated_w, data = alldata_reduced)\n\nexotics.interaction.lm1b <- lm(exotics ~ CVAnnBFI.x + I(CVAnnBFI.x^2)+LSMeanDur.x + I(LSMeanDur.x^2)+HSPeak.x + I(HSPeak.x^2) + production_irrigated_w + CVAnnBFI.x:production_irrigated_w, data = alldata_reduced)\n\nexotics.full.lm.dredge <- dredge(exotics.full.lm, m.max = 6, trace=TRUE)\nsubset(exotics.full.lm.dredge, delta < 4)\n\nexotics.best1a <- lm(exotics ~ +LSMeanDur.x + I(LSMeanDur.x^2)+HSPeak.x + I(HSPeak.x^2) + production_irrigated_w  + production_natural_w, data = alldata_reduced)\nexotics.best1b <- lm(exotics ~ +LSMeanDur.x + I(LSMeanDur.x^2)+HSPeak.x + I(HSPeak.x^2) + production_irrigated_w + I(production_irrigated_w^2) + production_natural_w + LSMeanDur.x:production_irrigated_w, data = alldata_reduced)\nexotics.best1c <- lm(exotics ~ +LSMeanDur.x + I(LSMeanDur.x^2)+HSPeak.x + I(HSPeak.x^2) + production_irrigated_w + production_natural_w, data = alldata_reduced)\nexotics.best1d <- lm(exotics ~ +LSMeanDur.x + I(LSMeanDur.x^2)+HSPeak.x + I(HSPeak.x^2), data = alldata_reduced)\n\nAICc(exotics.x.lm,\n     exotics.x.lme,\n     exotics.landuse.lm,\n     exotics.landuse.lme,\n     exotics.y.lm,\n     exotics.y.lme,\n     exotics.soil.lm,\n     exotics.soil.lme,\n     exotics.clim.lm,\n     exotics.clim.lme,\n     exotics.full.lm,\n     exotics.interaction.lm1a,\n     exotics.interaction.lm1b,\n     exotics.best1a,\n     exotics.best1b,\n     exotics.best1c,\n     exotics.best1d)\n     \n# order: flow mod., hydrology, land use, climate, soil, exotics\n  \nexotics.full.varpart <- varpart(alldata_reduced$exotics, \n                                \n                            #    ~C_MinM.y + I(C_MinM.y^2),\n                                \n                                 ~ #CVAnnBFI.x + I(CVAnnBFI.x^2)\n                              # + LSMeanDur.x + I(LSMeanDur.x^2)\n                               # +HSPeak.x + I(HSPeak.x^2),\n                              \n                              ~ CVAnnBFI.x + I(CVAnnBFI.x^2) + \n                              C_MaxM.x +\n                              CVMDFDry.x + I(CVMDFDry.x^2) +\n                              CVAnnHSMeanDur.x,\n                                \n                                ~production_irrigated_w + I(production_irrigated_w^2) \n                                + production_natural_w,\n                            #    +conservation_w + I(conservation_w^2),\n                                \n                                \n                                ~ soil_phc + soil_der,\n                                \n                                ~ clim_pdry + I(clim_pdry^2),\n                                \n                                data = alldata_reduced)\n  \nexotics.full.varpart  \nplot(exotics.full.varpart)\nplot(exotics.full.varpart, bg = c(gray(0.1,1)), Xnames= c('flow mod.','hydrology','land use','climate'), id.size = 1)  \n\n# richness (ACE.stand) #\n\ngetAllStats(alldata_reduced, alldata_reduced$richness, FD)\n\nrichness.x.varpart <- varpart(alldata_reduced$richness, \n                              ~C_MinM.x + I(C_MinM.x^2),\n                            #  ~CVAnnHSMeanDur.x,\n                              ~M_MinM.x,\n                              ~HSMeanDur.x + I(HSMeanDur.x^2),\n                              data = alldata_reduced)\nrichness.x.varpart                              \nplot(richness.x.varpart)\n\n\nrichness.y.varpart <- varpart(alldata_reduced$richness,\n                              ~M_MinM.y + I(M_MinM.y^2),\n                              ~HSMeanDur.y + I(HSMeanDur.y^2), \n                              data = alldata_reduced)\nrichness.y.varpart                              \nplot(richness.y.varpart)\n\n\nrichness.clim.varpart <- varpart(alldata_reduced$richness,\n                                 ~ clim_pwet,\n                                # ~clim_tsea + I(clim_tsea^2),\n                                 ~clim_pdry,\n                                 ~clim_tcld + I(clim_tcld^2),\n                                 data = alldata_reduced)\nplot(richness.clim.varpart)\nrichness.clim.varpart\n\nrichness.soil.varpart <- varpart(alldata_reduced$richness, \n                                 ~ soil_pto,\n                                 ~ soil_phc, \n                                 ~ soil_soc,\n                                 data = alldata_reduced)\nrichness.soil.varpart\nplot(richness.soil.varpart)\n\n\nrichness.x.lm <- lm(richness \n                    ~C_MinM.x + I(C_MinM.x^2)\n                   + M_MinM.x\n                   + HSMeanDur.x + I(HSMeanDur.x^2),\n                    data = alldata_reduced)\n\nrichness.y.lm <- lm(richness ~ M_MinM.y + I(M_MinM.y^2) + HSMeanDur.y + I(HSMeanDur.y^2), data = alldata_reduced)\n\nrichness.clim.lm <- lm(richness ~ clim_pwet + clim_pdry + clim_tcld + I(clim_tcld^2), data = alldata_reduced)\n\nrichness.soil.lm <- lm(richness ~ soil_pto + soil_phc + soil_soc, data = alldata_reduced)\n\nrichness.landuse.lm <- lm(richness ~ production_dryland_w + I(production_dryland_w^2), data = alldata_reduced)\n\nrichness.all.lm <- lm(richness ~ M_MinM.y + I(M_MinM.y^2) + HSMeanDur.y + I(HSMeanDur.y^2) + clim_pwet + clim_pdry + clim_tcld + I(clim_tcld^2) + C_MinM.x + I(C_MinM.x^2)+ M_MinM.x + HSMeanDur.x + I(HSMeanDur.x^2), data = alldata_reduced)\n\nrichness.combined.lm1 <- lm(richness ~M_MinM.y + I(M_MinM.y^2) + HSMeanDur.y + I(HSMeanDur.y^2) + clim_tsea, data = alldata_reduced)\n\nrichness.combined.lm2 <- lm(richness ~M_MinM.y + I(M_MinM.y^2) + HSMeanDur.y + I(HSMeanDur.y^2) + clim_tsea + M_MinM.y:clim_tsea, data = alldata_reduced)\n\nrichness.combined.lm3 <- lm(richness ~ C_MinM.x + I(C_MinM.x^2) + M_MinM.x + HSMeanDur.x + I(HSMeanDur.x^2) + M_MinM.y + I(M_MinM.y^2) + HSMeanDur.y + I(HSMeanDur.y^2) + clim_pwet + clim_pdry + clim_tcld + I(clim_tcld^2), data = alldata_reduced)\n\nrichness.combined.lm4 <- lm(richness ~M_MinM.y + I(M_MinM.y^2) + HSMeanDur.y + I(HSMeanDur.y^2) + clim_pdry + HSMeanDur.y:clim_pdry, data = alldata_reduced)\n\nrichness.combined.lm5 <- lm(richness ~M_MinM.y + I(M_MinM.y^2) + HSMeanDur.y + I(HSMeanDur.y^2) + clim_pdry + clim_tsea + HSMeanDur.y:clim_pdry +  M_MinM.y:clim_tsea, data = alldata_reduced)\n\nrichness.combined.lm6 <- lm(richness ~M_MinM.y + I(M_MinM.y^2) + HSMeanDur.y + I(HSMeanDur.y^2) + clim_pdry + clim_tsea, data = alldata_reduced)\n\n\nAICc(richness.x.lm,\n     richness.y.lm,\n     richness.clim.lm,\n     richness.soil.lm,\n     richness.landuse.lm,\n     richness.all.lm,\n     richness.combined.lm1,\n     richness.combined.lm2,\n     richness.combined.lm3,\n     richness.combined.lm4,\n     richness.combined.lm5,\n     richness.combined.lm6)\n\nrichness.all.varpart <- varpart(alldata_reduced$richness,\n                               ~ C_MinM.x + I(C_MinM.x^2) + M_MinM.x + HSMeanDur.x + I(HSMeanDur.x^2),\n                                \n                                ~M_MinM.y + I(M_MinM.y^2) + HSMeanDur.y + I(HSMeanDur.y^2),\n                                \n                                ~clim_pwet + clim_pdry + clim_tcld + I(clim_tcld^2),\n                                \n                           #    ~soil_pto + soil_phc + soil_soc,\n                                \n                           #     ~production_dryland_w + I(production_dryland_w^2),\n                                \n                                data = alldata_reduced)\nrichness.all.varpart\nplot(richness.all.varpart)\n\n\n# richness (area standardised) #\n\ngetAllStats(alldata_reduced, alldata_reduced$richness.stand, FD)\n\nrichness.stand.y.varpart <- varpart(alldata_reduced$richness.stand,\n                                    ~M_MinM.y + I(M_MinM.y^2),\n                                    ~MDFMDFDry.y + I(MDFMDFDry.y^2),\n                                    data = alldata_reduced)\nrichness.stand.y.varpart\nplot(richness.stand.y.varpart) \n\nrichness.stand.climate <- varpart(alldata_reduced$richness.stand,\n                                  ~clim_pwet,\n                         #         ~clim_pdry,\n                                  ~clim_tsea,\n                          #        ~clim_tcld + I(clim_tcld^2),\n                                  data = alldata_reduced)\nrichness.stand.climate\nplot(richness.stand.climate)\n\nrichness.stand.soil <- varpart(alldata_reduced$richness.stand,\n                               ~soil_phc,\n                               ~soil_soc,\n                               ~soil_pto,\n                               data = alldata_reduced)\nrichness.stand.soil\nplot(richness.stand.soil)\n\nrichness.stand.x <- varpart(alldata_reduced$richness.stand,\n                            ~C_MinM.x + I(C_MinM.x^2),\n                            ~HSMeanDur.x + I(HSMeanDur.x^2),\n                           # ~CVAnnHSMeanDur.x,\n                            ~M_MinM.x,\n                          #  ~MDFAnnHSNum.x,\n                            ~ CVAnnHSPeak.x + I(CVAnnHSPeak.x^2),\n                            data = alldata_reduced)\nrichness.stand.x\nplot(richness.stand.x)\n\n# order: flow mod., hydrology, land use, climate, soil, exotics\n\nrichness.stand.varpart <- varpart(alldata_reduced$richness.stand,\n                                  ~M_MinM.y + MDFMDFDry.y + I(MDFMDFDry.x^2),\n                                 # ~clim_pwet + clim_tsea,\n                                 # ~soil_phc + soil_soc + soil_pto,\n                                  ~C_MinM.x + I(C_MinM.x^2) + HSMeanDur.x + I(HSMeanDur.x^2) + CVAnnHSMeanDur.x + M_MinM.x,\n                                  ~exotics,\n                                  ~production_dryland_w + I(production_dryland_w^2),\n                                  data = alldata_reduced)\nrichness.stand.varpart\nplot(richness.stand.varpart)\n\nrichness.stand.varpart <- varpart(alldata_reduced$richness.stand,\n                                  ~M_MinM.y + MDFMDFDry.y + I(MDFMDFDry.x^2),\n                                  # ~clim_pwet + clim_tsea,\n                                  # ~soil_phc + soil_soc + soil_pto,\n                                  ~C_MinM.x + I(C_MinM.x^2) + HSMeanDur.x + I(HSMeanDur.x^2) + MDFAnnHSNum.x + M_MinM.x,\n                                  ~exotics,\n                                  ~production_dryland_w + I(production_dryland_w^2),\n                                  data = alldata_reduced)\nrichness.stand.varpart\nplot(richness.stand.varpart)\n\n\nplot(richness.stand.varpart, bg = c(gray(0.1,1)), Xnames= c('flow mod.','hydrology','exotics'), id.size = 1)  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ngetAllStats(alldata_reduced, alldata_reduced$FDis.SES, FD)\n\n# SESFDis (trialswap #\n\nCVAnnHSMeanDur.x\nLSPeak.x\nC_MinM.x\nCVAnnBFI.x\nMDFMDFDry.x + I(MDFMDFDry.x^2)\nC_MaxM.x + I(C_MaxM.x^2)\nHSMeanDur.x + I(HSMeanDur.x^2)\n\nHSMeanDur.y\nMDFMDFDry.y + I(MDFMDFDry.y^2)\n\nclim_pwet\nclim_pdry\nclim_tsea + I(clim_tsea^2)\nclim_twrm\n\nsoil_soc\nsoil_phc + I(soil_phc^2)\nsoil_nto\n\nexotics\n\nFDis.SES.x.varpart <- varpart(alldata_reduced$FDis.SES,\n                            #  ~CVAnnHSMeanDur.x,\n                            #  ~LSPeak.x,\n                            #  ~C_MinM.x,\n                            #  ~CVAnnBFI.x,\n                            #  ~MDFMDFDry.x + I(MDFMDFDry.x^2),\n                              ~C_MaxM.x + I(C_MaxM.x^2),\n                              ~HSMeanDur.x + I(HSMeanDur.x^2),\n                              data = alldata_reduced)\nFDis.SES.x.varpart\nplot(FDis.SES.x.varpart)\n                              \nFDis.SES.y.varpart <- varpart(alldata_reduced$FDis.SES,\n                              ~HSMeanDur.y,\n                              ~MDFMDFDry.y + I(MDFMDFDry.y^2),\n                              data = alldata_reduced)\nFDis.SES.y.varpart\nplot(FDis.SES.y.varpart)\n\nFDis.SES.clim.varpart <- varpart(alldata_reduced$FDis.SES,\n                                 ~clim_pwet,\n                                 ~clim_pdry,\n                                 ~clim_tsea + I(clim_tsea^2),\n                               #  ~clim_twrm,\n                                 data = alldata_reduced)\nFDis.SES.clim.varpart\nplot(FDis.SES.clim.varpart)\n\nFDis.SES.soil.varpart <- varpart(alldata_reduced$FDis.SES,\n                                 ~soil_soc,\n                                ~ soil_phc + I(soil_phc^2),\n                                 ~soil_nto,\n                                data = alldata_reduced)\nFDis.SES.soil.varpart\nplot(FDis.SES.soil.varpart)\n                                 \n\n\nFDis.SES.varpart <- varpart(alldata_reduced$FDis.SES,\n                            ~C_MaxM.x + I(C_MaxM.x^2) + HSMeanDur.x + I(HSMeanDur.x^2),\n                         #   ~MDFMDFDry.y + I(MDFMDFDry.y^2),\n                         #   ~clim_pwet + clim_pdry + clim_tsea + I(clim_tsea^2),\n                            ~soil_phc + I(soil_phc^2),\n                         #  ~exotics,\n                            data = alldata_reduced)\nFDis.SES.varpart\nplot(FDis.SES.varpart)\n\n\nFDis.SES.lm <- lm(FDis.SES ~ C_MaxM.x + I(C_MaxM.x^2) + HSMeanDur.x + I(HSMeanDur.x^2) + soil_phc + I(soil_phc^2), data = alldata_reduced)\nsummary(FDis.SES.lm)\n\n\n\n\n\n# SESFDis abundance swap #\n\ngetAllStats(alldata_reduced, alldata_reduced$FDis.SES, FD)\n\n\nSESFDisabunswap.x.varpart <- varpart(alldata_reduced$FDis.SES, \n                                    # ~LSPeak.x,\n                                     ~C_MaxM.x + I(C_MaxM.x^2),\n                                     ~HSMeanDur.x,\n                                   #  ~CVAnnHSMeanDur.x,\n                                     data = alldata_reduced)\nSESFDisabunswap.x.varpart\nplot(SESFDisabunswap.x.varpart)       \n\nSESFDisabunswap.x.lm <- lm(FDis.SES ~ LSPeak.x + C_MaxM.x + I(C_MaxM.x^2) + HSMeanDur.x + CVAnnHSMeanDur.x, data = alldata_reduced)\nsubset(dredge(SESFDisabunswap.x.lm), delta < 4)\n\n\nblah <- lm(FDis.SES ~ soil_soc, alldata_reduced)\nblah1 <- lm(FDis.SES ~ soil_soc + I(soil_soc^2), alldata_reduced)\nAICc(blah,blah1)\n\nSESFDis.soil.varpart <- varpart(alldata_reduced$FDis.SES,\n                                ~soil_soc + I(soil_soc^2),\n                                ~soil_nto,\n                                data = alldata_reduced)\nSESFDis.soil.varpart                          \nplot(SESFDis.soil.varpart)\n\n\nSESFDisabunswap.soil.lm <- lm(FDis.SES ~ soil_soc + I(soil_soc^2) + soil_nto, data =alldata_reduced)\nsubset(dredge(SESFDisabunswap.soil.lm), delta < 4)\n\n\n\nSESFDisabunswap.varpart <- varpart(alldata_reduced$FDis.SES,\n                                   ~ C_MaxM.x + I(C_MaxM.x^2),\n                                   ~ clim_pwet,\n                                   ~ MDFAnnHSNum.y,\n                                   ~ soil_nto + I(soil_nto^2) + soil_soc + I(soil_soc^2),\n                                   data= alldata_reduced)\nSESFDisabunswap.varpart\nplot(SESFDisabunswap.varpart)\n\n\n\nSESFDisabunswap.lm <- lm(FDis.SES ~ C_MaxM.x + I(C_MaxM.x^2) +  soil_nto + soil_soc + I(soil_soc^2), data = alldata_reduced)\nSESFDisabunswap.lme <- lme(FDis.SES ~ C_MaxM.x + I(C_MaxM.x^2) +  soil_nto + soil_soc + I(soil_soc^2), random = ~1|replicate, data = alldata_reduced)\nAICc(SESFDisabunswap.lm,SESFDisabunswap.lme)\n\nx.dredge <- dredge(SESFDisabunswap.lme)\nsubset(x.dredge, delta < 4)\n\n# FRic.SES\n\n\ngetAllStats(alldata_reduced, alldata_reduced$FRic.SES, FD)\n\nblah1 <- lm(FRic.SES ~ LSPeak.x, alldata_reduced)\nblah2 <- lm(FRic.SES ~ LSPeak.x + I(LSPeak.x^2), alldata_reduced)\nAICc(blah1, blah2)\n\n\nFRic.SES.x.varpart <- varpart(alldata_reduced$FRic.SES,\n                              ~CVAnnBFI.x + I(CVAnnBFI.x^2),\n                              ~CVAnnHSMeanDur.x,\n                              ~HSMeanDur.x + I(HSMeanDur.x^2),\n                          #    ~C_MaxM.x,\n                          #    ~LSPeak.x,\n                              data = alldata_reduced)\nFRic.SES.x.varpart\nplot(FRic.SES.x.varpart)\n\n\nx <- varpart(alldata_reduced$FDis.SES,\n             ~ MDFAnnHSNum.x,\n             ~ CVAnnMDFHSNum.x,\n             alldata_reduced)\nx <- lm(\n\n\n\nFRic.SES.x.lm <- lm(FRic.SES ~ CVAnnBFI.x + I(CVAnnBFI.x^2) + CVAnnHSMeanDur.x + HSMeanDur.x + I(HSMeanDur.x^2) + C_MaxM.x + LSPeak.x, alldata_reduced)\nsubset(dredge(FRic.SES.x.lm), delta < 4)\n\n\n\nFRic.SES.soil.varpart <- varpart(alldata_reduced$FRic.SES,\n                             #    ~soil_phc,\n                                 ~soil_nto,\n                                 ~soil_soc,\n                                 data = alldata_reduced)\nFRic.SES.soil.varpart                                 \nplot(FRic.SES.soil.varpart)\n\nFRic.SES.soil.lm <- lm(FRic.SES ~ soil_phc + soil_nto + soil_soc, alldata_reduced)\nsubset(dredge(FRic.SES.soil.lm), delta < 4)\n\n\nFRic.SES.clim.varpart <- varpart(alldata_reduced$FRic.SES,\n                                 ~clim_pwet,\n                                 ~clim_tsea,\n                                 ~clim_pdry,\n                                 data = alldata_reduced)\nFRic.SES.clim.varpart                                 \nplot(FRic.SES.clim.varpart)\n\nFRic.SES.clim.lm <- lm(FRic.SES ~ clim_pwet + clim_tsea + clim_pdry, alldata_reduced)\nsubset(dredge(FRic.SES.clim.lm), delta < 4)\n\n\nFRic.SES.varpart <- varpart(alldata_reduced$FRic.SES,\n                            ~CVAnnBFI.x + I(CVAnnBFI.x^2) + HSMeanDur.x,\n                            ~soil_nto + soil_soc,\n                           ~clim_pwet,\n                            data = alldata_reduced)\nFRic.SES.varpart\nplot(FRic.SES.varpart)\n\nFRic.SES.lm <- lm(FRic.SES ~ CVAnnBFI.x + I(CVAnnBFI.x^2)  + HSMeanDur.x + I(HSMeanDur.x^2) + C_MaxM.x, data = alldata_reduced)\nsummary(FRic.SES.varpart.lm)\nFRic.SES.lme <- lme(FRic.SES ~ CVAnnBFI.x + I(CVAnnBFI.x^2)  + HSMeanDur.x + I(HSMeanDur.x^2) + C_MaxM.x, random = ~1|replicate, data = alldata_reduced)\nAICc(FRic.SES.lm,FRic.SES.lme)\n\nx.dredge <- dredge(FRic.SES.varpart.lm)\nsubset(x.dredge, delta < 4)\n\nFRic.SES.lm1 <- lm(FRic.SES ~ CVAnnBFI.x + I(CVAnnBFI.x^2)  + HSMeanDur.x, data = alldata_reduced)\nsummary(FRic.SES.lm1)\n\n\n\n\n\n\n\n\n\n\n\nFDiv.SES.x.varpart <- varpart(alldata_reduced$FDiv.SES,\n                              ~CVAnnBFI.x + I(CVAnnBFI.x^2),\n                              ~MDFMDFDry.x + I(MDFMDFDry.x^2),\n                              ~LSPeak.x + I(LSPeak.x^2),\n                            #  ~C_MaxM.x + I(C_MaxM.x^2),\n                              data = alldata_reduced)\nFDiv.SES.x.varpart\nplot(FDiv.SES.x.varpart)\n\nFDiv.SES.soil.varpart <- varpart(alldata_reduced$FDiv.SES,\n                               ~  soil_nto + I(soil_nto^2),\n                                ~ soil_soc,\n                               data= alldata_reduced)\nFDiv.SES.soil.varpart\nplot(FDiv.SES.soil.varpart)\n\n\nFDiv.SES.varpart <- varpart(alldata_reduced$FDiv.SES,\n                            ~ CVAnnBFI.x + I(CVAnnBFI.x^2) + MDFMDFDry.x + I(MDFMDFDry.x^2) + LSPeak.x + I(LSPeak.x^2),\n                            ~ soil_nto + I(soil_nto^2) + soil_soc,\n                            ~ clim_twrm + I(clim_twrm^2),\n                            data = alldata_reduced)\nFDiv.SES.varpart\nplot(FDiv.SES.varpart)\n\n\n\n\n\n\n\n\n\n\n\n",
    "created" : 1435890975271.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1542817364",
    "id" : "CA582FD9",
    "lastKnownWriteTime" : 1438304962,
    "path" : "C:/Users/James/Desktop/stuff/data/analysis/R/SEQLD_fixed/scripts/model_building3.R",
    "project_path" : "scripts/model_building3.R",
    "properties" : {
        "tempName" : "Untitled9"
    },
    "relative_order" : 10,
    "source_on_save" : false,
    "type" : "r_source"
}