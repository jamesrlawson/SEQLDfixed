{
    "contents" : "hydro <- read.csv(\"data/hydro_1975-2008.csv\", header=T)\nsites <- read.csv(\"data/sites.csv\", header=T)\nclimate <- read.csv(\"data/sites_clim_soil.csv\", header=T) \nhydro_to1999 <- read.csv(\"data/hydro_1975-1999.csv\", header=TRUE)\nhydro_IQQM <- read.csv(\"data/hydro_IQQM.csv\", header=TRUE)\nsites <- read.csv(\"data/sites.csv\", header=TRUE)\nlanduse <- read.csv(\"data/landuse.csv\", header=TRUE)\nFRic.SES.stats <- read.csv(\"data/SESFRic_stats.csv\", header=TRUE)\nFDis.SES.stats <- read.csv(\"data/SESFDis_stats.csv\", header=TRUE)\n\n# add climate and soil variables\n\n    climate.site <- climate$site\n    climate <- data.frame(cbind(climate[,7:37], site = climate.site))\n    \n    hydro$MDF <- NULL\n    \n    hydrosites2 <- hydrosites[order(hydrosites$site),]\n    #hydrosites2 <- hydrosites2[,1:40]\n    \n    alldata <- merge(climate, hydrosites2, by=c(\"site\"))\n    \n    #alldata <- alldata[,2:71]\n    \n    \n    # PCA's \n    \n    clim.pca <- prcomp(alldata[,2:20], center=TRUE, scale=TRUE)\n    soil.pca <- prcomp(alldata[,21:32], center=TRUE, scale=TRUE)\n    #hydro.pca <- prcomp(alldata[,33:65], center=TRUE, scale=TRUE)\n    \n    summary(clim.pca)\n    summary(soil.pca)\n    #summary(hydro.pca)\n    \n    alldata$clim.pc1 <- clim.pca$x[,1]\n    alldata$clim.pc2 <- clim.pca$x[,2]\n    \n    alldata$soil.pc1 <- soil.pca$x[,1]\n    alldata$soil.pc2 <- soil.pca$x[,2]\n    alldata$soil.pc3 <- soil.pca$x[,3]\n    alldata$soil.pc4 <- soil.pca$x[,3]\n    \n    #alldata$hydro.pc1 <- hydro.pca$x[,1]\n    #alldata$hydro.pc2 <- hydro.pca$x[,2]\n    #alldata$hydro.pc3 <- hydro.pca$x[,3]\n    #alldata$hydro.pc4 <- hydro.pca$x[,4]\n    \n    #\n    \n    alldata$site <- siteNums\n    alldata$FDis <- FD$FDis\n    alldata$FDiv <- FD$FDiv\n    alldata$FRic <- FD$FRic\n    alldata$FEve <- FD$FEve\n    alldata$RaoQ <- FD$RaoQ\n    alldata$FGR <- FD$FGR\n    alldata$nbsp <- FD$nbsp\n    alldata$simpson <- FD.redun$Simpson\n    alldata$FunRao <- FD.redun$FunRao\n    alldata$redun <- FD.redun$FunRedundancy\n    alldata$nbsp <- FD$nbsp\n    alldata$richness <- richness$richness.stand.ACE\n    alldata$richness.stand <- richness$richness.stand\n    alldata$exotics <- exotics$proportionExotic\n    \n    alldata$SLA<- CWM$SLA\n    alldata$seed.mass <- CWM$seed.mass\n    alldata$maximum.height <- CWM$maximum.height\n    alldata$flowering.duration <- CWM$flowering.duration\n    alldata$wood.density <- CWM$wood.density\n    alldata$leaf.area <- CWM$leaf.area\n\n\n# calculate hydrological change metrics # \n\n    # remove Teviot @ Croftby and Burnett at U/S Maroon Dam, as neither have IQQM correlates\n    \n    hydro_to1999a <- hydro_to1999[-16,]\n    hydro_to1999a <- hydro_to1999a[-15,]\n    #hydro_IQQMa <- hydro_IQQM[-17,]\n    #hydro_IQQMa <- hydro_IQQM[-15,]\n    \n    hydro_to1999a <- hydro_to1999a[order(hydro_to1999a$gaugeID),]\n    hydro_IQQM <- hydro_IQQM[order(hydro_IQQM$gaugeID),]\n    \n    \n    hydro_compare <- rbind(hydro_to1999a, hydro_IQQM)\n    hydro_compare <- hydro_compare\n    \n    #hydro_compare <- hydro_compare[order(hydro_compare$gaugeID),] \n    #hydro_compare <- hydro_compare[1:40,]\n    rownames(hydro_compare) <- hydro_compare$gaugeName\n    hydro_compare <- hydro_compare[,4:36]\n    hydro_compare.dis <- vegdist(hydro_compare, method=\"gower\")\n    #hydro_compare.dis <- daisy(hydro_compare, metric=\"manhattan\", stand=TRUE)\n    #View(as.matrix(hydro_compare.dis))\n    \n    #write.csv(as.matrix(hydro_compare.dis), file=\"output/gower.csv\")\n    \n    \n    \n    # find percent change from IQQM for each metric\n    \n    #hydro_to1999a[17,\"MDFAnnZer\"] <- 0.01 # incrementing zero, otherwise inf's are produced\n    #hydro_to1999a[20,\"MDFAnnZer\"] <- 0.01\n    \n    hydro_change <- compare.hydro(hydro_to1999a[,4:36],hydro_IQQM[,4:36])\n    \n    #hydro_change[1,\"MDFAnnZer\"] <- 0 # zero divided by zero\n    \n    hydro_change$MDFAnnZer <- NULL # too complicated to try and work out what percent changes from zero should be\n    \n    # merge with alldata\n    \n    hydro_change$gaugeID <- hydro_to1999a$gaugeID\n    hydro_change <- merge(hydro_change, sites, by = \"gaugeID\")\n    hydro_change <- hydro_change[order(hydro_change$site),]\n    hydro_change <- hydro_change[,2:34]\n    alldata1 <- merge(alldata, hydro_change, by=\"site\", all.x = TRUE, fill=\"NA\")\n    \n    hydrochange.pca <- prcomp(hydro_change[,1:32], center=TRUE, scale=TRUE, retx=TRUE)\n\n#    hydro_change1 <- hydro_change\n#    hydro_change1$regulation <- alldata1.naomit$regulation\n#    getAllStats(hydro_change1, hydro_change1$regulation, FD)\n#    rm(hydro_change1)\n    \n    \n# add in landuse data\n    \n    alldata1 <- merge(alldata1, landuse, by=\"site\", all.x = TRUE, fill=\"NA\")\n    \n    alldata1$richness.stand <- alldata$richness.stand\n    alldata1$FRic.SES <- hydrosites$FRic.SES\n    alldata1$FDis.SES <- hydrosites$FDis.SES\n    \n    \n    \n    alldata1.naomit <- na.omit(alldata1)\n\n    \n #   getAllStats(alldata1.naomit, alldata1.naomit$FDis.SES, FD)\n #   getAllStats(alldata1.naomit, alldata1.naomit$FRic.SES, FD)\n #   getAllStats(alldata1.naomit, alldata1.naomit$FEve.SES, FD)\n  #  getAllStats(alldata1.naomit, alldata1.naomit$FDiv.SES, FD)\n    \n    \nwrite.csv(alldata1.naomit, \"output/alldata1naomity.csv\")\n    \n    alldata_reduced$FRic.SES <- alldata1.naomit$FRic.SES\n    alldata_reduced$FDis.SES <- alldata1.naomit$FDis.SES\n    \n#write.csv(alldata_reduced, \"data/alldata_reduced1.csv\")\n          ",
    "created" : 1432793949619.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1672428975",
    "id" : "92BC24F1",
    "lastKnownWriteTime" : 1438066198,
    "path" : "C:/Users/James/Desktop/stuff/data/analysis/R/SEQLD/scripts/envdata.R",
    "project_path" : "scripts/envdata.R",
    "properties" : {
        "tempName" : "Untitled6"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_source"
}